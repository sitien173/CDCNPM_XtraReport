/**
* DevExpress Analytics (query-builder\dataSource\_dbSchemaProvider.js)
* Version:  21.2.7
* Build date: Apr 13, 2022
* Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED
* License: https://www.devexpress.com/Support/EULAs/universal.xml
*/
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var $ = require("jquery");
var dbSchema_1 = require("./dbSchema");
var _infoMessageHelpers_1 = require("../../core/utils/_infoMessageHelpers");
var _utils_1 = require("../../property-grid/widgets/internal/_utils");
var localization_utils_1 = require("../../property-grid/localization/localization_utils");
function getDBSchemaCallback(requestWrapper, connection, tables) {
    var deferred = $.Deferred();
    requestWrapper.getDbSchema(connection, tables)
        .done(function (data) {
        deferred.resolve(new dbSchema_1.DBSchema(JSON.parse(data.dbSchemaJSON)));
    })
        .fail(function (data) {
        _infoMessageHelpers_1.ShowMessage(_utils_1.formatUnicorn(localization_utils_1.getLocalization('Schema loading failed. {0}', 'DxDesignerStringId.Error_SchemaLoadingFailed'), _infoMessageHelpers_1.getErrorMessage(data)));
        deferred.reject();
    });
    return deferred.promise();
}
exports.getDBSchemaCallback = getDBSchemaCallback;
function getDBStoredProceduresCallback(requestWrapper, connection) {
    var deferred = $.Deferred();
    requestWrapper.getDbStoredProcedures(connection)
        .done(function (data) {
        deferred.resolve(new dbSchema_1.DBSchema(JSON.parse(data.dbSchemaJSON)).procedures);
    })
        .fail(function (data) {
        _infoMessageHelpers_1.ShowMessage(_utils_1.formatUnicorn(localization_utils_1.getLocalization('Stored procedures loading failed. {0}', 'DxDesignerStringId.Error_SchemaLoadingFailed'), _infoMessageHelpers_1.getErrorMessage(data)));
        deferred.reject();
    });
    return deferred.promise();
}
exports.getDBStoredProceduresCallback = getDBStoredProceduresCallback;
